import*as e from"jose";let r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=async()=>new Uint32Array(crypto.getRandomValues(new Uint8Array(4)).buffer)[0],n=()=>e.base64url.encode(crypto.getRandomValues(new Uint8Array(20))),o=async e=>new Uint8Array(await crypto.subtle.digest("SHA-256",new TextEncoder().encode(e))),a=e=>e.map(e=>[Math.random(),e]).sort((e,r)=>e[0]-r[0]).map(e=>e[1]);function d(e=16){return l(Array.from(crypto.getRandomValues(new Uint8Array(e))))}function c(e,r){if(e.length!==r.length)return!1;let t=0;for(let n=0;n<e.length;n++)t|=e.charCodeAt(n)^r.charCodeAt(n);return 0===t}let l=e=>e.map(e=>e.toString(16).padStart(2,"0")).join(""),s=r=>e.base64url.encode(r),u=r=>e.base64url.decode(r),i=r=>new TextDecoder().decode(e.base64url.decode(r)),m=e=>{let t=r.length;if(e<0)throw Error("Input must be a non-negative number");if(e<t)return r[e];let n="",o=e;for(;o>0;)n=r[(o-1)%t]+n,o=Math.floor((o-1)/t);return n};export{u as base64Decode,i as base64DecodeString,s as base64Encode,t as random32,n as random64,d as randomSalt,a as shuffle,c as timingSafeCompare,m as toBase,l as toHex,o as toJweKey};